# Fail2ban jail configuration for cloud storage
# Add this to /etc/fail2ban/jail.local

[nginx-ddos]
enabled = true
filter = nginx-ddos
logpath = /var/log/nginx/access.log
maxretry = 20
findtime = 60
bantime = 3600
action = iptables-multiport[name=nginx-ddos, port="http,https"]

[nginx-rate-limit]
enabled = true
filter = nginx-rate-limit
logpath = /var/log/nginx/error.log
maxretry = 5
findtime = 300
bantime = 3600
action = iptables-multiport[name=nginx-rate-limit, port="http,https"]

[nginx-404]
enabled = true
filter = nginx-404
logpath = /var/log/nginx/access.log
maxretry = 10
findtime = 300
bantime = 1800
action = iptables-multiport[name=nginx-404, port="http,https"]

[nginx-upload-abuse]
enabled = true
filter = nginx-upload-abuse
logpath = /var/log/nginx/access.log
maxretry = 3
findtime = 60
bantime = 7200
action = iptables-multiport[name=nginx-upload-abuse, port="http,https"]